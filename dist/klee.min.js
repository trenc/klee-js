var M="0.3.4";function C(l){return{debugLevel:0,responsive:!0,renderer:{type:"WebGLRenderer",args:[{antialias:!0,preserveDrawingBuffer:!0,alpha:!0}],domElement:"body",clearColor:"#000000",opacity:1,properties:{shadowMap:{enabled:!0,type:l.PCFSoftShadowMap}}},camera:{type:"PerspectiveCamera",methods:{lookAt:[0,0,0]},properties:{position:{x:-1,y:2,z:5},name:"camera-1",fov:35,aspect:window.innerWidth/window.innerHeight,near:1,far:300}},scene:{type:"Scene",properties:{name:"scene-1",position:{x:0,y:0,z:0}}}}}var g=class{static merge(s,r){if(!r||typeof r!="object")return s;for(let a of Object.keys(r))r[a]instanceof Object&&typeof s[a]!="undefined"&&Object.assign(r[a],this.merge(s[a],r[a]));return Object.assign(s||{},r),s}static isThreeColorValue(s){return["color","specular","emissive","diffuse","background","sheen"].includes(s)}static applyMethods(s,r){r=r||{};for(let a in r){let e=Array.isArray(r[a])?r[a]:[];a in s?s[a](...e):console.log("Applied object has no method: "+a)}return s}};var n=function(){let l={},s,r={canvas:null,camera:null,renderer:null,scene:null,mouse:null,raycaster:null,manager:null,controls:{OrbitControls:null},draggables:[],actions:{isDragging:!1}};function a(c,d={}){(!c||!c.REVISION)&&m("THREE is not inserted"),s={...c},(!d||typeof d!="object")&&(d={},y("Options are set to default values")),l={...g.merge(C(s),d)},r.renderer=t(l.renderer),r.manager=new s.LoadingManager}function e(c){r.renderer.render(r.scene,r.camera),r.controls.OrbitControls&&(r.controls.OrbitControls.enableDamping||r.controls.OrbitControls.autoRotate)&&r.controls.OrbitControls.update(),typeof c=="function"&&c(),requestAnimationFrame(()=>e(c))}function i(){let c=l.responsive||!1,d=r.camera.fov,p=r.canvas.clientWidth,v=r.canvas.clientWidth,x=r.canvas.clientHeight;r.renderer.setSize(v,x),r.camera.aspect=v/x,r.camera.updateProjectionMatrix(),c!==!1&&window.addEventListener("resize",()=>{let R=window.innerWidth;v=r.canvas.clientWidth,x=r.canvas.clientHeight,R!==v&&(r.renderer.setSize(R,x),r.camera.aspect=R/x,r.camera.fov=d*p/R,r.camera.updateProjectionMatrix())})}function t(c){let d=document.querySelector(c.domElement);d instanceof HTMLCanvasElement&&(c.args.canvas=d,r.canvas=d);let p=o(c);return p=u(p,c.properties),p.setClearColor(new s.Color(c.clearColor),c.opacity),p.setPixelRatio(window.devicePixelRatio),r.canvas||(d.appendChild(p.domElement),r.canvas=p.domElement),p.setSize(r.canvas.clientWidth,r.canvas.clientHeight),p}function o(c){let d=Array.isArray(c.args)?c.args:[];return new s[c.type](...d)}function u(c,d){return g.merge(c,d)}function f(c,d){let p=l.debugLevel!==void 0?l.debugLevel:3;switch(d){case"error":throw c;case"warn":p>0&&console.warn(c);break;case"info":p>2&&console.info(c);break;default:p>1&&console.log(c);break}}function m(c){f(c,"error")}function y(c){f(c,"warn")}function E(c){f(c,"log")}function T(c){f(c,"info")}return{get canvas(){return r.canvas},get options(){return l},get THREE(){return s},get scene(){return r.scene},set scene(c){r.scene=c},get camera(){return r.camera},set camera(c){r.camera=c},get controls(){return r.controls},get renderer(){return r.renderer},get manager(){return r.manager},get draggables(){return r.draggables},get mouse(){return r.mouse},set mouse(c){r.mouse=c},get raycaster(){return r.raycaster},set raycaster(c){r.raycaster=c},get actions(){return r.actions},initSize:i,create:o,error:m,warn:y,log:E,info:T,init:a,run:e}}();var H=function(){function l(a,e){let i={draggable:t=>s(a,t),raycasterPlane:t=>r(a,t)};for(let t in e)i[t]||n.warn("The userData \xBB"+t+"\xAB can not be handled by app."),i[t](t)}function s(a,e){e&&n.draggables.push(a)}function r(a,e){e&&(n.raycasterPlane=a)}return{handle:l}}(n);var h=function(){function l(e){let i=s(e);return n.scene.add(i),i}function s(e){let i=n.THREE,t=Array.isArray(e.args)?e.args:[],o=new i[e.type](...t);return o=r(o,e),o}function r(e,i){return i.properties&&(e=a(e,i.properties)),i.methods&&(e=g.applyMethods(e,i.methods)),e}function a(e,i){let t=n.THREE;if(!i||typeof i!="object")return e;for(let o in i)if(i[o]instanceof Object)if("copy"in e[o]){if("toVector3"in e[o]&&"setFromVector3"in e[o]){let f=new t.Vector3;f.setFromEuler(e[o]);let m={...f,...i[o]};e[o].setFromVector3(m)}let u={...e[o],...i[o]};e[o].copy(u)}else o==="userData"&&H.handle(e,i[o]),e[o]=a(e[o],i[o]);else g.isThreeColorValue(o)?e[o]=new t.Color(i[o]):e[o]=i[o];return e}return{add:l,create:s,change:r}}(n);var S=function(){function l(){let e=n.options;n.camera=r(e.camera),n.scene=s(e.scene),n.initSize()}function s(e){let i=h.create(e);return(async()=>{i.background=await a(e.background),i.environment=await a(e.environment)})(),i}function r(e){let i=h.create(e);return i.updateProjectionMatrix(),i}async function a(e){if(!e)return null;let i=n.THREE,t=e.loader||"TextureLoader";return await new i[t](n.manager).loadAsync(e.url)}return{init:l}}(n);var L=function(){function l(r,a){n.controls[r.name]=s(r,a)}function s(r,a){let e=new r(n.camera,n.renderer.domElement);return e=h.change(e,a),e}return{init:l}}(n);var O=function(){let l={};function s(a){l[a.name]=new a(n.manager)}async function r(a){return await l[a.loader].loadAsync(a.url)}return{init:s,load:r}}(n);var P=function(){function l(e){return h.create(e)}function s(e,i){return e=h.change(e,i),e}function r(e){if(typeof e=="object"&&e.type)return a(e);let i=[];return Array.isArray(e)&&e.forEach(t=>{let o=a(t);i.push(o)}),i}function a(e){let i=l(e);return n.scene.add(i),i}return{add:r,create:l,change:s}}(n);var b=function(){function l(a){a||(a={type:"MeshPhongMaterial",args:[{color:16777215}]},n.info("No options for material given, using default MeshPhongMaterial in white"));let e=n.create(a);return e=s(e,a),e}function s(a,e){let i=n.THREE;return e.properties&&(a=r(a,e.properties)),e.methods&&(a=g.applyMethods(a,e.methods)),e.textures&&(e.textures.forEach(async t=>{let o=t.loader||"TextureLoader",u=new i[o](n.manager),f=t.map,m=await u.loadAsync(t.url);a[f]=m,t.properties&&(a[f]=r(a[f],t.properties)),t.methods&&(a[f]=g.applyMethods(a,t.methods))}),a.needsUpdate=!0),a}function r(a,e){let i=n.THREE;if(!e||typeof e!="object")return a;for(let t in e)e[t]instanceof Object?a[t]={...e[t]}:g.isThreeColorValue(t)?a[t]=new i.Color(e[t]):a[t]=e[t];return a}return{create:l,change:s}}(n);var A=function(){function l(s){s||(s={type:"BoxGeometry",args:[1,1,1]},n.info("No options for geometry given, using default BoxGeometry 1x1x1"));let r=n.create(s);return r=g.merge(r,s.properties),r}return{create:l}}(n);var D=function(){function l(t){let o=n.THREE,u=b.create(t.material),f=A.create(t.geometry),m=new o.Mesh(f,u);return m=i(m,t),m}function s(t){if(typeof t=="object"){if(t.loader)return r(t);if(t.geometry)return e(t)}let o=[];return Array.isArray(t)&&t.forEach(u=>{let f=s(u);o.push(f)}),o}async function r(t){let o=await O.load(t);if(o.scene){let u=a(o.scene,t);return u=i(u,t),u.receiveShadow=!1,u.castShadow=!1,n.scene.add(u),u}else return o=i(o,t),n.scene.add(o),o}function a(t,o){let u=n.THREE,f=new u.Box3().setFromObject(t),m=f.getCenter(new u.Vector3),y=.001,E={x:f.max.x-f.min.x+y,y:f.max.y-f.min.y+y,z:f.max.z-f.min.z+y},T=new u.BoxGeometry(E.x,E.y,E.z);o.material||(o.material={color:16777215,transparent:!0,opacity:0});let c=new u.MeshBasicMaterial(o.material),d=new u.Mesh(T,c);return d.position.y=E.y/2,t.position.x+=t.position.x-m.x,t.position.y+=t.position.y-m.y,t.position.z+=t.position.z-m.z,d.renderOrder=1,t.traverse(p=>{p.isMesh&&(p.receiveShadow=o.properties.receiveShadow||!1,p.castShadow=o.properties.castShadow||!1,p.material.side=u.DoubleSide)}),d.add(t),d}function e(t){let o=l(t);return n.scene.add(o),o}function i(t,o){return t=h.change(t,o),o.material&&b.change(t.material,o.material),t}return{add:s,create:l,change:i}}(n);var w=function(){let l=null,s=null,r=null,a=null,e=null,i=[];function t(m){let y=n.THREE;l=new y.Plane,s=new y.Vector3(0,1,0),r=new y.Vector3,a=new y.Vector3,i=m}function o(){let m=n.raycaster.intersectObjects(i);m.length<=0||(r.copy(m[0].point),l.setFromNormalAndCoplanarPoint(s,r),a.subVectors(m[0].object.position,m[0].point),e=m[0].object,n.controls.OrbitControls.enabled=!1,n.actions.isDragging=!0,n.canvas.style.cursor="grab")}function u(){e=null,n.controls.OrbitControls.enabled=!0,n.actions.isDragging=!1,n.canvas.style.cursor="auto"}function f(){n.actions.isDragging&&(e.position.addVectors(r,a),n.raycaster.ray.intersectPlane(l,r))}return{init:t,start:o,drag:f,stop:u}}();var V=function(){let l;async function s(){let i=n.THREE;n.raycaster=n.raycaster??new i.Raycaster,n.mouse=n.mouse??{},w.init(n.draggables);let t=await n.renderer.domElement;l=t.getBoundingClientRect(),t.addEventListener("mousemove",o=>{e(o)}),t.addEventListener("mousedown",o=>{r(o)}),t.addEventListener("mouseup",o=>{a(o)})}function r(){w.start()}function a(){w.stop()}function e(i){n.mouse.x=(i.clientX-l.left)/(l.right-l.left)*2-1,n.mouse.y=-((i.clientY-l.top)/(l.bottom-l.top))*2+1,n.raycaster.setFromCamera(n.mouse,n.camera),w.drag()}return{init:s}}();console.log("klee.js: "+M);export{n as App,L as Controls,w as Dragging,V as Events,A as Geometry,D as Item,M as KLEEVERSION,P as Light,O as Loaders,b as Material,h as Object3d,S as Scene};
//# sourceMappingURL=klee.min.js.map
