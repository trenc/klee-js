var A="0.3.7";function C(l){return{debugLevel:0,responsive:!0,renderer:{type:"WebGLRenderer",args:[{antialias:!0,preserveDrawingBuffer:!0,alpha:!0}],domElement:"body",clearColor:"#000000",opacity:1,properties:{shadowMap:{enabled:!0,type:l.PCFSoftShadowMap}}},camera:{type:"PerspectiveCamera",methods:{lookAt:[0,0,0]},properties:{position:{x:-1,y:2,z:5},name:"camera-1",fov:35,aspect:window.innerWidth/window.innerHeight,near:1,far:300}},scene:{type:"Scene",properties:{name:"scene-1",position:{x:0,y:0,z:0}}}}}var y=class{static merge(s,r){if(!r||typeof r!="object")return s;for(let n of Object.keys(r))r[n]instanceof Object&&typeof s[n]!="undefined"&&Object.assign(r[n],this.merge(s[n],r[n]));return Object.assign(s||{},r),s}static isThreeColorValue(s){return["color","specular","emissive","diffuse","background","sheen"].includes(s)}static applyMethods(s,r){r=r||{};for(let n in r){let e=Array.isArray(r[n])?r[n]:[];n in s?s[n](...e):console.log("Applied object has no method: "+n)}return s}};var o=function(){let l={},s,r={canvas:null,camera:null,renderer:null,scene:null,mouse:null,raycaster:null,manager:null,controls:{OrbitControls:null},draggables:[],actions:{isDragging:!1}};function n(c,m={}){(!c||!c.REVISION)&&p("THREE is not inserted"),s={...c},(!m||typeof m!="object")&&(m={},g("Options are set to default values")),l={...y.merge(C(s),m)},r.renderer=t(l.renderer),r.manager=new s.LoadingManager}function e(c){r.renderer.render(r.scene,r.camera),r.controls.OrbitControls&&(r.controls.OrbitControls.enableDamping||r.controls.OrbitControls.autoRotate)&&r.controls.OrbitControls.update(),typeof c=="function"&&c(),requestAnimationFrame(()=>e(c))}function a(){let c=l.responsive||!1,m=r.camera.fov,d=r.canvas.clientWidth,M=r.canvas.clientWidth,v=r.canvas.clientHeight;r.renderer.setSize(M,v),r.camera.aspect=M/v,r.camera.updateProjectionMatrix(),c!==!1&&window.addEventListener("resize",()=>{let b=window.innerWidth;M=r.canvas.clientWidth,v=r.canvas.clientHeight,b!==M&&(r.renderer.setSize(b,v),r.camera.aspect=b/v,r.camera.fov=m*d/b,r.camera.updateProjectionMatrix())})}function t(c){let m=document.querySelector(c.domElement);m instanceof HTMLCanvasElement&&(c.args.canvas=m,r.canvas=m);let d=i(c);return d=u(d,c.properties),d.setClearColor(new s.Color(c.clearColor),c.opacity),d.setPixelRatio(window.devicePixelRatio),r.canvas||(m.appendChild(d.domElement),r.canvas=d.domElement),d.setSize(r.canvas.clientWidth,r.canvas.clientHeight),d}function i(c){let m=Array.isArray(c.args)?c.args:[];return new s[c.type](...m)}function u(c,m){return y.merge(c,m)}function f(c,m){let d=l.debugLevel!==void 0?l.debugLevel:3;switch(m){case"error":throw c;case"warn":d>0&&console.warn(c);break;case"info":d>2&&console.info(c);break;default:d>1&&console.log(c);break}}function p(c){f(c,"error")}function g(c){f(c,"warn")}function h(c){f(c,"log")}function R(c){f(c,"info")}return{get canvas(){return r.canvas},get options(){return l},get THREE(){return s},get scene(){return r.scene},set scene(c){r.scene=c},get camera(){return r.camera},set camera(c){r.camera=c},get controls(){return r.controls},get renderer(){return r.renderer},get manager(){return r.manager},get draggables(){return r.draggables},get mouse(){return r.mouse},set mouse(c){r.mouse=c},get raycaster(){return r.raycaster},set raycaster(c){r.raycaster=c},get actions(){return r.actions},initSize:a,create:i,error:p,warn:g,log:h,info:R,init:n,run:e}}();var w=function(){function l(n){n||(n={type:"MeshPhongMaterial",args:[{color:16777215}]},o.info("No options for material given, using default MeshPhongMaterial in white"));let e=o.create(n);return e=s(e,n),e}function s(n,e){let a=o.THREE;return e.properties&&(n=r(n,e.properties)),e.methods&&(n=y.applyMethods(n,e.methods)),e.textures&&(e.textures.forEach(async t=>{let i=t.loader||"TextureLoader",u=new a[i](o.manager),f=t.map,p=await u.loadAsync(t.url);n[f]=p,t.properties&&(n[f]=r(n[f],t.properties)),t.methods&&(n[f]=y.applyMethods(n,t.methods))}),n.needsUpdate=!0),n}function r(n,e){let a=o.THREE;if(!e||typeof e!="object")return n;for(let t in e)e[t]instanceof Object?n[t]={...e[t]}:y.isThreeColorValue(t)?n[t]=new a.Color(e[t]):n[t]=e[t];return n}return{create:l,change:s}}(o);var H=function(){function l(n,e){let a={draggable:t=>r(n,t),dragMaterial:t=>s(n,t)};for(let t in e){if(!a[t]){o.info("The userData \xBB"+t+"\xAB can not be handled by app.");return}a[t](t)}n.userData={...e}}function s(n,e){}function r(n,e){e&&o.draggables.push(n)}return{handle:l}}(o);var E=function(){function l(e){let a=s(e);return o.scene.add(a),a}function s(e){let a=o.THREE,t=Array.isArray(e.args)?e.args:[],i=new a[e.type](...t);return i=r(i,e),i}function r(e,a){return a.properties&&(e=n(e,a.properties)),a.methods&&(e=y.applyMethods(e,a.methods)),e}function n(e,a){let t=o.THREE;if(!a||typeof a!="object")return e;for(let i in a)if(a[i]instanceof Object)if(typeof e[i]!="undefined"&&"copy"in e[i]){if("toVector3"in e[i]&&"setFromVector3"in e[i]){let f=new t.Vector3;f.setFromEuler(e[i]);let p={...f,...a[i]};e[i].setFromVector3(p)}let u={...e[i],...a[i]};e[i].copy(u)}else i==="userData"?H.handle(e,a[i]):e[i]=n(e[i],a[i]);else y.isThreeColorValue(i)?e[i]=new t.Color(a[i]):e[i]=a[i];return e}return{add:l,create:s,change:r}}(o);var S=function(){function l(){let e=o.options;o.camera=r(e.camera),o.scene=s(e.scene),o.initSize()}function s(e){let a=E.create(e);return(async()=>{a.background=await n(e.background),a.environment=await n(e.environment)})(),a}function r(e){let a=E.create(e);return a.updateProjectionMatrix(),a}async function n(e){if(!e)return null;let a=o.THREE,t=e.loader||"TextureLoader";return await new a[t](o.manager).loadAsync(e.url)}return{init:l}}(o);var D=function(){function l(r,n){o.controls[r.name]=s(r,n)}function s(r,n){let e=new r(o.camera,o.renderer.domElement);return e=E.change(e,n),e}return{init:l}}(o);var T=function(){let l={};function s(n){l[n.name]=new n(o.manager)}async function r(n){return await l[n.loader].loadAsync(n.url)}return{init:s,load:r}}(o);var L=function(){function l(e){return E.create(e)}function s(e,a){return e=E.change(e,a),e}function r(e){if(typeof e=="object"&&e.type)return n(e);let a=[];return Array.isArray(e)&&e.forEach(t=>{let i=n(t);a.push(i)}),a}function n(e){let a=l(e);return o.scene.add(a),a}return{add:r,create:l,change:s}}(o);var O=function(){function l(s){s||(s={type:"BoxGeometry",args:[1,1,1]},o.info("No options for geometry given, using default BoxGeometry 1x1x1"));let r=o.create(s);return r=y.merge(r,s.properties),r}return{create:l}}(o);var V=function(){function l(t){let i=o.THREE,u=w.create(t.material),f=O.create(t.geometry),p=new i.Mesh(f,u);return p=a(p,t),p}function s(t){if(typeof t=="object"){if(t.loader)return r(t);if(t.geometry)return e(t)}let i=[];return Array.isArray(t)&&t.forEach(u=>{let f=s(u);i.push(f)}),i}async function r(t){let i=await T.load(t);if(i.scene){let u=n(i.scene,t);return u=a(u,t),u.receiveShadow=!1,u.castShadow=!1,o.scene.add(u),u}else return i=a(i,t),o.scene.add(i),i}function n(t,i){let u=o.THREE,f=new u.Box3().setFromObject(t),p=f.getCenter(new u.Vector3),g=.001,h={x:f.max.x-f.min.x+g,y:f.max.y-f.min.y+g,z:f.max.z-f.min.z+g},R=new u.BoxGeometry(h.x,h.y,h.z);i.material||(i.material={color:16777215,transparent:!0,opacity:0});let c=new u.MeshBasicMaterial(i.material),m=new u.Mesh(R,c);return m.position.y=h.y/2,t.position.x+=t.position.x-p.x,t.position.y+=t.position.y-p.y,t.position.z+=t.position.z-p.z,m.renderOrder=1,t.traverse(d=>{d.isMesh&&(d.receiveShadow=i.properties.receiveShadow||!1,d.castShadow=i.properties.castShadow||!1,d.material.side=u.DoubleSide)}),m.add(t),m}function e(t){let i=l(t);return o.scene.add(i),i}function a(t,i){return t=E.change(t,i),i.material&&w.change(t.material,i.material),t}return{add:s,create:l,change:a}}(o);var x=function(){let l=null,s=null,r=null,n=null,e=null,a=null,t=[];function i(g){let h=o.THREE;s=new h.Plane,r=new h.Vector3(0,1,0),n=new h.Vector3,e=new h.Vector3,t=g}function u(){let g=o.raycaster.intersectObjects(t);g.length<=0||(n.copy(g[0].point),s.setFromNormalAndCoplanarPoint(r,n),e.subVectors(g[0].object.position,g[0].point),a=g[0].object,o.controls.OrbitControls.enabled=!1,o.actions.isDragging=!0,o.canvas.style.cursor="grab",a.userData.dragMaterial&&(l=a.material,a.material=w.create(a.userData.dragMaterial)))}function f(){o.controls.OrbitControls.enabled=!0,o.actions.isDragging=!1,o.canvas.style.cursor="auto",a&&a.userData.dragMaterial&&(a.material=l,l=null),a=null}function p(){o.actions.isDragging&&(a.position.addVectors(n,e),o.raycaster.ray.intersectPlane(s,n))}return{init:i,start:u,drag:p,stop:f}}();var P=function(){let l;async function s(){let a=o.THREE;o.raycaster=o.raycaster??new a.Raycaster,o.mouse=o.mouse??{},x.init(o.draggables);let t=await o.renderer.domElement;l=t.getBoundingClientRect(),t.addEventListener("mousemove",i=>{e(i)}),t.addEventListener("mousedown",i=>{r(i)}),t.addEventListener("mouseup",i=>{n(i)})}function r(a){if(a.button!==0)return!1;x.start()}function n(){x.stop()}function e(a){if(o.mouse.x=(a.clientX-l.left)/(l.right-l.left)*2-1,o.mouse.y=-((a.clientY-l.top)/(l.bottom-l.top))*2+1,o.raycaster.setFromCamera(o.mouse,o.camera),a.button!==0)return!1;x.drag()}return{init:s}}();console.log("klee.js: "+A);export{o as App,D as Controls,x as Dragging,P as Events,O as Geometry,V as Item,A as KLEEVERSION,L as Light,T as Loaders,w as Material,E as Object3d,S as Scene};
//# sourceMappingURL=klee.min.js.map
