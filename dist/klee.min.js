var L="0.4.0";function A(l){return{debugLevel:0,responsive:!0,renderer:{type:"WebGLRenderer",args:[{antialias:!0,preserveDrawingBuffer:!0,alpha:!0}],domElement:"body",clearColor:"#000000",opacity:1,properties:{shadowMap:{enabled:!0,type:l.PCFSoftShadowMap}}},camera:{type:"PerspectiveCamera",methods:{lookAt:[0,0,0]},properties:{position:{x:-1,y:2,z:5},name:"camera-1",fov:35,aspect:window.innerWidth/window.innerHeight,near:1,far:300}},scene:{type:"Scene",properties:{name:"scene-1",position:{x:0,y:0,z:0}}}}}var p=class{static merge(c,r){if(!r||typeof r!="object")return c;for(let i of Object.keys(r))r[i]instanceof Object&&typeof c[i]!="undefined"&&Object.assign(r[i],this.merge(c[i],r[i]));return Object.assign(c||{},r),c}static isThreeColorValue(c){return["color","specular","emissive","diffuse","background","sheen"].includes(c)}static applyMethods(c,r){r=r||{};for(let i in r){let e=Array.isArray(r[i])?r[i]:[];i in c?c[i](...e):console.log("Applied object has no method: "+i)}return c}};var n=function(){let l={},c,r={canvas:null,camera:null,renderer:null,scene:null,mouse:null,raycaster:null,manager:null,controls:{OrbitControls:null},movingLimits:null,draggables:[],actions:{isDragging:!1}};function i(s,f={}){(!s||!s.REVISION)&&d("THREE is not inserted"),c={...s},(!f||typeof f!="object")&&(f={},h("Options are set to default values")),l={...p.merge(A(c),f)},r.renderer=a(l.renderer),r.manager=new c.LoadingManager}function e(s){r.renderer.render(r.scene,r.camera),r.controls.OrbitControls&&(r.controls.OrbitControls.enableDamping||r.controls.OrbitControls.autoRotate)&&r.controls.OrbitControls.update(),typeof s=="function"&&s(),requestAnimationFrame(()=>e(s))}function t(){let s=l.responsive||!1,f=r.camera.fov,g=r.canvas.clientWidth,M=r.canvas.clientWidth,w=r.canvas.clientHeight;if(r.renderer.setSize(M,w),r.camera.aspect=M/w,r.camera.updateProjectionMatrix(),s===!1)return;new ResizeObserver(F=>{let b=window.innerWidth;M=r.canvas.clientWidth,w=r.canvas.clientHeight,b!==M&&(r.renderer.setSize(b,w),r.camera.aspect=b/w,r.camera.fov=f*g/b,r.camera.updateProjectionMatrix())}).observe(document.querySelector("body"))}function a(s){r.domElement=document.querySelector(s.domElement),r.domElement instanceof HTMLCanvasElement&&(s.args.canvas=r.domElement,r.canvas=r.domElement);let f=o(s);return f=m(f,s.properties),f.setClearColor(new c.Color(s.clearColor),s.opacity),f.setPixelRatio(window.devicePixelRatio),r.canvas||(r.domElement.appendChild(f.domElement),r.canvas=f.domElement),f.setSize(r.canvas.clientWidth,r.canvas.clientHeight),f}function o(s){let f=Array.isArray(s.args)?s.args:[];return new c[s.type](...f)}function m(s,f){return p.merge(s,f)}function u(s,f){let g=l.debugLevel!==void 0?l.debugLevel:3;switch(f){case"error":throw s;case"warn":g>0&&console.warn(s);break;case"info":g>2&&console.info(s);break;default:g>1&&console.log(s);break}}function d(s){u(s,"error")}function h(s){u(s,"warn")}function E(s){u(s,"log")}function R(s){u(s,"info")}return{get canvas(){return r.canvas},get options(){return l},get THREE(){return c},get scene(){return r.scene},set scene(s){r.scene=s},get camera(){return r.camera},set camera(s){r.camera=s},get controls(){return r.controls},get renderer(){return r.renderer},get manager(){return r.manager},get draggables(){return r.draggables},set draggables(s){r.draggables=s},get mouse(){return r.mouse},set mouse(s){r.mouse=s},get movingLimits(){return r.movingLimits},set movingLimits(s){r.movingLimits=s},get raycaster(){return r.raycaster},set raycaster(s){r.raycaster=s},get actions(){return r.actions},initSize:t,create:o,error:d,warn:h,log:E,info:R,init:i,run:e}}();var v=function(){function l(i){i||(i={type:"MeshPhongMaterial",args:[{color:16777215}]},n.info("No options for material given, using default MeshPhongMaterial in white"));let e=n.create(i);return e=c(e,i),e}function c(i,e){let t=n.THREE;return e.properties&&(i=r(i,e.properties)),e.methods&&(i=p.applyMethods(i,e.methods)),e.textures&&(e.textures.forEach(async a=>{let o=a.loader||"TextureLoader",m=new t[o](n.manager),u=a.map,d=await m.loadAsync(a.url);i[u]=d,a.properties&&(i[u]=r(i[u],a.properties)),a.methods&&(i[u]=p.applyMethods(i,a.methods))}),i.needsUpdate=!0),i}function r(i,e){let t=n.THREE;if(!e||typeof e!="object")return i;for(let a in e)e[a]instanceof Object?i[a]={...e[a]}:p.isThreeColorValue(a)?i[a]=new t.Color(e[a]):i[a]=e[a];return i}return{create:l,change:c}}(n);var H=function(){function l(e,t){let a={draggable:o=>i(e,o),dragMaterial:o=>r(e,o),movingLimiter:o=>c(e,o)};for(let o in t)a[o]&&a[o](o);e.userData={...e.userData,...t}}function c(e,t){let a=n.THREE,o=new a.Box3;o.setFromObject(e),n.movingLimits={min:o.min,max:o.max}}function r(e,t){}function i(e,t){t&&n.draggables.push(e)}return{handle:l}}(n);var y=function(){function l(e){let t=c(e);return n.scene.add(t),t}function c(e){let t=n.THREE,a=Array.isArray(e.args)?e.args:[],o=new t[e.type](...a);return o=r(o,e),o}function r(e,t){return t.properties&&(e=i(e,t.properties)),t.methods&&(e=p.applyMethods(e,t.methods)),e}function i(e,t){let a=n.THREE;if(!t||typeof t!="object")return e;for(let o in t)if(t[o]instanceof Object)if(typeof e[o]!="undefined"&&"copy"in e[o]){if("toVector3"in e[o]&&"setFromVector3"in e[o]){let u=new a.Vector3;u.setFromEuler(e[o]);let d={...u,...t[o]};e[o].setFromVector3(d)}let m={...e[o],...t[o]};e[o].copy(m)}else o==="userData"?H.handle(e,t[o]):e[o]=i(e[o],t[o]);else p.isThreeColorValue(o)?e[o]=new a.Color(t[o]):e[o]=t[o];return e}return{add:l,create:c,change:r}}(n);var C=function(){function l(){let e=n.options;n.camera=r(e.camera),n.scene=c(e.scene),n.initSize()}function c(e){let t=y.create(e);return(async()=>{t.background=await i(e.background),t.environment=await i(e.environment)})(),t}function r(e){let t=y.create(e);return t.updateProjectionMatrix(),t}async function i(e){if(!e)return null;let t=n.THREE,a=e.loader||"TextureLoader";return await new t[a](n.manager).loadAsync(e.url)}return{init:l}}(n);var S=function(){function l(r,i){n.controls[r.name]=c(r,i)}function c(r,i){let e=new r(n.camera,n.renderer.domElement);return e=y.change(e,i),e}return{init:l}}(n);var O=function(){let l={};function c(i){l[i.name]=new i(n.manager)}async function r(i){return await l[i.loader].loadAsync(i.url)}return{init:c,load:r}}(n);var D=function(){function l(e){return y.create(e)}function c(e,t){return e=y.change(e,t),e}function r(e){if(typeof e=="object"&&e.type)return i(e);let t=[];return Array.isArray(e)&&e.forEach(a=>{let o=i(a);t.push(o)}),t}function i(e){let t=l(e);return n.scene.add(t),t}return{add:r,create:l,change:c}}(n);var T=function(){function l(c){c||(c={type:"BoxGeometry",args:[1,1,1]},n.info("No options for geometry given, using default BoxGeometry 1x1x1"));let r=n.create(c);return r=p.merge(r,c.properties),r}return{create:l}}(n);var z=function(){function l(a){let o=n.THREE,m=v.create(a.material),u=T.create(a.geometry),d=new o.Mesh(u,m);return d=t(d,a),d}function c(a){if(typeof a=="object"){if(a.loader)return r(a);if(a.geometry)return e(a)}let o=[];return Array.isArray(a)&&a.forEach(m=>{let u=c(m);o.push(u)}),o}async function r(a){let o=await O.load(a);if(o.scene){let m=i(o.scene,a);return m=t(m,a),m.receiveShadow=!1,m.castShadow=!1,n.scene.add(m),m}else return o=t(o,a),n.scene.add(o),o}function i(a,o){let m=n.THREE,u=new m.Box3().setFromObject(a),d=u.getCenter(new m.Vector3),h=.001,E={x:u.max.x-u.min.x+h,y:u.max.y-u.min.y+h,z:u.max.z-u.min.z+h},R=new m.BoxGeometry(E.x,E.y,E.z);o.material||(o.material={color:16777215,transparent:!0,opacity:0});let s=new m.MeshBasicMaterial(o.material),f=new m.Mesh(R,s);return f.position.y=E.y/2,a.position.x+=a.position.x-d.x,a.position.y+=a.position.y-d.y,a.position.z+=a.position.z-d.z,f.renderOrder=1,a.traverse(g=>{g.isMesh&&(g.receiveShadow=o.properties.receiveShadow||!1,g.castShadow=o.properties.castShadow||!1,g.material.side=m.DoubleSide)}),f.add(a),f}function e(a){let o=l(a);return n.scene.add(o),o}function t(a,o){return a=y.change(a,o),o.material&&v.change(a.material,o.material),a}return{add:c,create:l,change:t}}(n);var x=function(){let l=null,c=null,r=null,i=null,e=null,t=null;function a(){let d=n.THREE;c=new d.Plane,r=new d.Vector3(0,1,0),i=new d.Vector3,e=new d.Vector3}function o(){let d=n.raycaster.intersectObjects(n.draggables);d.length<=0||(i.copy(d[0].point),c.setFromNormalAndCoplanarPoint(r,i),e.subVectors(d[0].object.position,d[0].point),t=d[0].object,n.controls.OrbitControls.enabled=!1,n.actions.isDragging=!0,n.canvas.style.cursor="grab",t.userData.dragMaterial&&(l=t.material,t.material=v.create(t.userData.dragMaterial)))}function m(){n.controls.OrbitControls.enabled=!0,n.actions.isDragging=!1,n.canvas.style.cursor="auto",t&&t.userData.dragMaterial&&(t.material=l,l=null),t=null}function u(){n.actions.isDragging&&(t.position.addVectors(i,e),n.movingLimits!==null&&(n.movingLimits.min.y=t.position.y,n.movingLimits.max.y=t.position.y,t.position.clamp(n.movingLimits.min,n.movingLimits.max)),n.raycaster.ray.intersectPlane(c,i))}return{init:a,start:o,drag:u,stop:m}}();var V=function(){async function l(){let e=n.THREE;n.raycaster=n.raycaster??new e.Raycaster,n.mouse=n.mouse??{},x.init(n.draggables);let t=await n.renderer.domElement;t.addEventListener("mousemove",a=>{i(a)}),t.addEventListener("mousedown",a=>{c(a)}),t.addEventListener("mouseup",a=>{r(a)})}function c(e){x.start()}function r(){x.stop()}function i(e){let t=n.canvas.getBoundingClientRect();n.mouse.x=(e.clientX-t.left)/(t.right-t.left)*2-1,n.mouse.y=-((e.clientY-t.top)/(t.bottom-t.top))*2+1,n.raycaster.setFromCamera(n.mouse,n.camera),x.drag()}return{init:l}}();console.log("klee.js: "+L);export{n as App,S as Controls,x as Dragging,V as Events,T as Geometry,z as Item,L as KLEEVERSION,D as Light,O as Loaders,v as Material,y as Object3d,C as Scene};
//# sourceMappingURL=klee.min.js.map
