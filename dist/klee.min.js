var C="0.5.4";function L(m){return{debugLevel:0,responsive:!0,renderer:{type:"WebGLRenderer",args:[{antialias:!0,preserveDrawingBuffer:!0,alpha:!0}],domElement:"body",clearColor:"#000000",opacity:1,properties:{shadowMap:{enabled:!0,type:m.PCFSoftShadowMap}}},camera:{type:"PerspectiveCamera",methods:{lookAt:[0,0,0]},properties:{position:{x:-1,y:2,z:5},name:"camera-1",fov:35,aspect:window.innerWidth/window.innerHeight,near:1,far:300}},scene:{type:"Scene",properties:{name:"scene-1",position:{x:0,y:0,z:0}}}}}var g=class{static merge(c,r){if(!r||typeof r!="object")return c;for(let o of Object.keys(r))r[o]instanceof Object&&typeof c[o]!="undefined"&&Object.assign(r[o],this.merge(c[o],r[o]));return Object.assign(c||{},r),c}static isThreeColorValue(c){return["color","specular","emissive","diffuse","background","sheen"].includes(c)}static applyMethods(c,r){r=r||{};for(let o in r){let t=Array.isArray(r[o])?r[o]:[];o in c?c[o](...t):console.log("Applied object has no method: "+o)}return c}};var e=function(){let m={},c,r={canvas:null,camera:null,renderer:null,scene:null,mouse:null,raycaster:null,manager:null,controls:{OrbitControls:null},movingLimits:null,draggables:[],draggableObject:null,collidables:[],actions:{isDragging:!1}};function o(s,d={}){(!s||!s.REVISION)&&f("THREE is not inserted"),c={...s},(!d||typeof d!="object")&&(d={},b("Options are set to default values")),m={...g.merge(L(c),d)},r.renderer=n(m.renderer),r.manager=new c.LoadingManager}function t(s){r.renderer.render(r.scene,r.camera),r.controls.OrbitControls&&(r.controls.OrbitControls.enableDamping||r.controls.OrbitControls.autoRotate)&&r.controls.OrbitControls.update(),typeof s=="function"&&s(),requestAnimationFrame(()=>t(s))}function a(){let s=m.responsive||!1,d=r.camera.fov,p=r.canvas.clientWidth,w=r.canvas.clientWidth,v=r.canvas.clientHeight;if(r.renderer.setSize(w,v),r.camera.aspect=w/v,r.camera.updateProjectionMatrix(),s===!1)return;new ResizeObserver(k=>{let O=window.innerWidth;w=r.canvas.clientWidth,v=r.canvas.clientHeight,O!==w&&(r.renderer.setSize(O,v),r.camera.aspect=O/v,r.camera.fov=d*p/O,r.camera.updateProjectionMatrix())}).observe(document.querySelector("body"))}function n(s){r.domElement=document.querySelector(s.domElement),r.domElement instanceof HTMLCanvasElement&&(s.args.canvas=r.domElement,r.canvas=r.domElement);let d=i(s);return d=l(d,s.properties),d.setClearColor(new c.Color(s.clearColor),s.opacity),d.setPixelRatio(window.devicePixelRatio),r.canvas||(r.domElement.appendChild(d.domElement),r.canvas=d.domElement),d.setSize(r.canvas.clientWidth,r.canvas.clientHeight),d}function i(s){let d=Array.isArray(s.args)?s.args:[];return new c[s.type](...d)}function l(s,d){return g.merge(s,d)}function u(s,d){let p=m.debugLevel!==void 0?m.debugLevel:3;switch(d){case"error":throw s;case"warn":p>0&&console.warn(s);break;case"info":p>2&&console.info(s);break;default:p>1&&console.log(s);break}}function f(s){u(s,"error")}function b(s){u(s,"warn")}function h(s){u(s,"log")}function M(s){u(s,"info")}return{get canvas(){return r.canvas},get options(){return m},get THREE(){return c},get scene(){return r.scene},set scene(s){r.scene=s},get camera(){return r.camera},set camera(s){r.camera=s},get controls(){return r.controls},get renderer(){return r.renderer},get manager(){return r.manager},get collidables(){return r.collidables},set collidables(s){r.collidables=s},get draggableObject(){return r.draggableObject},set draggableObject(s){r.draggableObject=s},get draggables(){return r.draggables},set draggables(s){r.draggables=s},get mouse(){return r.mouse},set mouse(s){r.mouse=s},get movingLimits(){return r.movingLimits},set movingLimits(s){r.movingLimits=s},get raycaster(){return r.raycaster},set raycaster(s){r.raycaster=s},get actions(){return r.actions},initSize:a,create:i,error:f,warn:b,log:h,info:M,init:o,run:t}}();var E=function(){function m(o){o||(o={type:"MeshPhongMaterial",args:[{color:16777215}]},e.info("No options for material given, using default MeshPhongMaterial in white"));let t=e.create(o);return t=c(t,o),t}function c(o,t){let a=e.THREE;return t.properties&&(o=r(o,t.properties)),t.methods&&(o=g.applyMethods(o,t.methods)),t.textures&&(t.textures.forEach(async n=>{let i=n.loader||"TextureLoader",l=new a[i](e.manager),u=n.map,f=await l.loadAsync(n.url);o[u]=f,n.properties&&(o[u]=r(o[u],n.properties)),n.methods&&(o[u]=g.applyMethods(o,n.methods))}),o.needsUpdate=!0),o}function r(o,t){let a=e.THREE;if(!t||typeof t!="object")return o;for(let n in t)t[n]instanceof Object?o[n]={...t[n]}:g.isThreeColorValue(n)?o[n]=new a.Color(t[n]):o[n]=t[n];return o}return{create:m,change:c}}(e);var A=function(){function m(a,n){let i={collidable:l=>t(a,l),draggable:l=>o(a,l),dragMaterial:l=>r(a,l),movingLimiter:l=>c(a,l)};for(let l in n)i[l]&&i[l](l);a.userData={...a.userData,...n}}function c(a,n){let i=e.THREE,l=new i.Box3;l.setFromObject(a),e.movingLimits={min:l.min,max:l.max}}function r(a,n){}function o(a,n){n&&e.draggables.push(a)}function t(a,n){n&&e.collidables.push(a)}return{handle:m}}(e);var y=function(){function m(t){let a=c(t);return e.scene.add(a),a}function c(t){let a=e.THREE,n=Array.isArray(t.args)?t.args:[],i=new a[t.type](...n);return i=r(i,t),i}function r(t,a){return a.properties&&(t=o(t,a.properties)),a.methods&&(t=g.applyMethods(t,a.methods)),t}function o(t,a){let n=e.THREE;if(!a||typeof a!="object")return t;for(let i in a)if(a[i]instanceof Object)if(typeof t[i]!="undefined"&&"copy"in t[i]){if("toVector3"in t[i]&&"setFromVector3"in t[i]){let u=new n.Vector3;u.setFromEuler(t[i]);let f={...u,...a[i]};t[i].setFromVector3(f)}let l={...t[i],...a[i]};t[i].copy(l)}else i==="userData"?A.handle(t,a[i]):t[i]=o(t[i],a[i]);else g.isThreeColorValue(i)?t[i]=new n.Color(a[i]):t[i]=a[i];return t}return{add:m,create:c,change:r}}(e);var S=function(){function m(){let t=e.options;e.camera=r(t.camera),e.scene=c(t.scene),e.initSize()}function c(t){let a=y.create(t);return(async()=>{a.background=await o(t.background),a.environment=await o(t.environment)})(),a}function r(t){let a=y.create(t);return a.updateProjectionMatrix(),a}async function o(t){if(!t)return null;let a=e.THREE,n=t.loader||"TextureLoader";return await new a[n](e.manager).loadAsync(t.url)}return{init:m}}(e);var D=function(){function m(r,o){e.controls[r.name]=c(r,o)}function c(r,o){let t=new r(e.camera,e.renderer.domElement);return t=y.change(t,o),t}return{init:m}}(e);var R=function(){let m={};function c(o){m[o.name]=new o(e.manager)}async function r(o){return await m[o.loader].loadAsync(o.url)}return{init:c,load:r}}(e);var H=function(){function m(t){return y.create(t)}function c(t,a){return t=y.change(t,a),t}function r(t){if(typeof t=="object"&&t.type)return o(t);let a=[];return Array.isArray(t)&&t.forEach(n=>{let i=o(n);a.push(i)}),a}function o(t){let a=m(t);return e.scene.add(a),a}return{add:r,create:m,change:c}}(e);var T=function(){function m(c){c||(c={type:"BoxGeometry",args:[1,1,1]},e.info("No options for geometry given, using default BoxGeometry 1x1x1"));let r=e.create(c);return r=g.merge(r,c.properties),r}return{create:m}}(e);var j=function(){function m(n){let i=e.THREE,l=E.create(n.material),u=T.create(n.geometry),f=new i.Mesh(u,l);return f=a(f,n),f}function c(n){if(typeof n=="object"){if(n.loader)return r(n);if(n.geometry)return t(n)}let i=[];return Array.isArray(n)&&n.forEach(l=>{let u=c(l);i.push(u)}),i}async function r(n){let i=await R.load(n);if(i.scene){let l=o(i.scene,n);return l=a(l,n),l.receiveShadow=!1,l.castShadow=!1,e.scene.add(l),l}else return i=a(i,n),e.scene.add(i),i}function o(n,i){let l=e.THREE,u=new l.Box3().setFromObject(n),f=u.getCenter(new l.Vector3),b=.001,h={x:u.max.x-u.min.x+b,y:u.max.y-u.min.y+b,z:u.max.z-u.min.z+b},M=new l.BoxGeometry(h.x,h.y,h.z);i.material||(i.material={color:16777215,transparent:!0,opacity:0});let s=new l.MeshBasicMaterial(i.material),d=new l.Mesh(M,s);return d.position.y=h.y/2,n.position.x+=n.position.x-f.x,n.position.y+=n.position.y-f.y,n.position.z+=n.position.z-f.z,d.renderOrder=1,n.traverse(p=>{p.isMesh&&(p.receiveShadow=i.properties.receiveShadow||!1,p.castShadow=i.properties.castShadow||!1,p.material.side=l.DoubleSide)}),d.add(n),d}function t(n){let i=m(n);return e.scene.add(i),i}function a(n,i){return n=y.change(n,i),i.material&&E.change(n.material,i.material),n}return{add:c,create:m,change:a}}(e);var x=function(){let m=null,c=null,r=null,o=null,t=null;function a(){let u=e.THREE;c=new u.Plane,r=new u.Vector3(0,1,0),o=new u.Vector3,t=new u.Vector3}function n(){let u=e.raycaster.intersectObjects(e.draggables);if(u.length<=0)return;o.copy(u[0].point),c.setFromNormalAndCoplanarPoint(r,o),t.subVectors(u[0].object.position,u[0].point),e.draggableObject=u[0].object,e.controls.OrbitControls.enabled=!1,e.actions.isDragging=!0,e.canvas.style.cursor="grab",(e.draggableObject.userData?.callbacks?.onDragStart??(()=>{}))(e.draggableObject),e.draggableObject.userData.dragMaterial&&(m=e.draggableObject.material,e.draggableObject.material=E.create(e.draggableObject.userData.dragMaterial))}function i(){e.controls.OrbitControls.enabled=!0,e.actions.isDragging=!1,e.canvas.style.cursor="auto",e.draggableObject&&(e.draggableObject.userData?.callbacks?.onDragStop??(()=>{}))(e.draggableObject),e.draggableObject&&e.draggableObject.userData.dragMaterial&&(e.draggableObject.material=m,m=null),e.draggableObject=null}function l(){e.actions.isDragging&&(e.draggableObject.position.addVectors(o,t),e.movingLimits!==null&&(e.movingLimits.min.y=e.draggableObject.position.y,e.movingLimits.max.y=e.draggableObject.position.y,e.draggableObject.position.clamp(e.movingLimits.min,e.movingLimits.max)),e.raycaster.ray.intersectPlane(c,o))}return{init:a,start:n,drag:l,stop:i}}();var z=function(){async function m(){let t=e.THREE;e.raycaster=e.raycaster??new t.Raycaster,e.mouse=e.mouse??{},x.init(e.draggables);let a=await e.renderer.domElement;a.addEventListener("mousemove",n=>{o(n)}),a.addEventListener("mousedown",n=>{c(n)}),a.addEventListener("mouseup",n=>{r(n)})}function c(t){x.start()}function r(){x.stop()}function o(t){let a=e.canvas.getBoundingClientRect();e.mouse.x=(t.clientX-a.left)/(a.right-a.left)*2-1,e.mouse.y=-((t.clientY-a.top)/(a.bottom-a.top))*2+1,e.raycaster.setFromCamera(e.mouse,e.camera),x.drag()}return{init:m}}();var V=function(){function m(c){let r=e.THREE,o=!1,t=new r.Box3().setFromObject(c);return e.collidables.forEach(a=>{if(a===c)return;let n=new r.Box3().setFromObject(a);t.intersectsBox(n)&&(o=!0)}),o}return{check:m}}(e);console.log("klee.js: "+C);export{e as App,V as Collision,D as Controls,x as Dragging,z as Events,T as Geometry,j as Item,C as KLEEVERSION,H as Light,R as Loaders,E as Material,y as Object3d,S as Scene};
//# sourceMappingURL=klee.min.js.map
