var T="0.7.4";function S(m){return{debugLevel:0,responsive:!0,renderer:{type:"WebGLRenderer",args:[{antialias:!0,preserveDrawingBuffer:!0,alpha:!0}],domElement:"body",clearColor:"#000000",opacity:1,properties:{shadowMap:{enabled:!0,type:m.PCFSoftShadowMap}}},camera:{type:"PerspectiveCamera",methods:{lookAt:[0,0,0]},properties:{position:{x:-1,y:2,z:5},name:"camera-1",fov:35,aspect:window.innerWidth/window.innerHeight,near:1,far:300}},scene:{type:"Scene",properties:{name:"scene-1",position:{x:0,y:0,z:0}}}}}var g=class{static merge(c,t){if(!t||typeof t!="object")return c;for(let o of Object.keys(t))t[o]instanceof Object&&typeof c[o]!="undefined"&&Object.assign(t[o],this.merge(c[o],t[o]));return Object.assign(c||{},t),c}static isThreeColorValue(c){return["color","specular","emissive","diffuse","background","sheen"].includes(c)}static applyMethods(c,t){t=t||{};for(let o in t){let r=Array.isArray(t[o])?t[o]:[];o in c?c[o](...r):console.log("Applied object has no method: "+o)}return c}};var e=function(){let m={},c,t={canvas:null,camera:null,renderer:null,scene:null,mouse:null,raycaster:null,manager:null,controls:{OrbitControls:null},movingLimits:null,draggables:[],draggableObject:null,collidables:[],actions:{isDragging:!1}};function o(s,d={}){(!s||!s.REVISION)&&f("THREE is not inserted"),c={...s},(!d||typeof d!="object")&&(d={},y("Options are set to default values")),m={...g.merge(S(c),d)},t.renderer=l(m.renderer),t.manager=new c.LoadingManager}function r(s){t.renderer.render(t.scene,t.camera),t.controls.OrbitControls&&(t.controls.OrbitControls.enableDamping||t.controls.OrbitControls.autoRotate)&&t.controls.OrbitControls.update(),typeof s=="function"&&s(),requestAnimationFrame(()=>r(s))}function a(){let s=m.responsive||!1,d=t.camera.fov,p=t.canvas.clientWidth,h=t.canvas.clientWidth,O=t.canvas.clientHeight;if(t.renderer.setSize(h,O),t.camera.aspect=h/O,t.camera.updateProjectionMatrix(),s===!1)return;new ResizeObserver(P=>{let D=window.innerWidth;h=t.canvas.clientWidth,O=t.canvas.clientHeight,D!==h&&(t.renderer.setSize(D,O),t.camera.aspect=D/O,t.camera.fov=d*p/D,t.camera.updateProjectionMatrix())}).observe(document.querySelector("body"))}function l(s){t.domElement=document.querySelector(s.domElement),t.domElement instanceof HTMLCanvasElement&&(s.args.canvas=t.domElement,t.canvas=t.domElement);let d=n(s);return d=i(d,s.properties),d.setClearColor(new c.Color(s.clearColor),s.opacity),d.setPixelRatio(window.devicePixelRatio),t.canvas||(t.domElement.appendChild(d.domElement),t.canvas=d.domElement),d.setSize(t.canvas.clientWidth,t.canvas.clientHeight),d}function n(s){let d=Array.isArray(s.args)?s.args:[];return new c[s.type](...d)}function i(s,d){return g.merge(s,d)}function u(s,d){let p=m.debugLevel!==void 0?m.debugLevel:3;switch(d){case"error":throw s;case"warn":p>0&&console.warn(s);break;case"info":p>2&&console.info(s);break;default:p>1&&console.log(s);break}}function f(s){u(s,"error")}function y(s){u(s,"warn")}function w(s){u(s,"log")}function E(s){u(s,"info")}return{get canvas(){return t.canvas},get options(){return m},get THREE(){return c},get scene(){return t.scene},set scene(s){t.scene=s},get camera(){return t.camera},set camera(s){t.camera=s},get controls(){return t.controls},get renderer(){return t.renderer},get manager(){return t.manager},get collidables(){return t.collidables},set collidables(s){t.collidables=s},get draggableObject(){return t.draggableObject},set draggableObject(s){t.draggableObject=s},get draggables(){return t.draggables},set draggables(s){t.draggables=s},get mouse(){return t.mouse},set mouse(s){t.mouse=s},get movingLimits(){return t.movingLimits},set movingLimits(s){t.movingLimits=s},get raycaster(){return t.raycaster},set raycaster(s){t.raycaster=s},get actions(){return t.actions},initSize:a,create:n,error:f,warn:y,log:w,info:E,init:o,run:r}}();var v=function(){function m(o){o||(o={type:"MeshPhongMaterial",args:[{color:16777215}]},e.info("No options for material given, using default MeshPhongMaterial in white"));let r=e.create(o);return r=c(r,o),r}function c(o,r){let a=e.THREE;return r.properties&&(o=t(o,r.properties)),r.methods&&(o=g.applyMethods(o,r.methods)),r.textures&&(r.textures.forEach(async l=>{let n=l.loader||"TextureLoader",i=new a[n](e.manager),u=l.map,f=await i.loadAsync(l.url);o[u]=f,l.properties&&(o[u]=t(o[u],l.properties)),l.methods&&(o[u]=g.applyMethods(o,l.methods))}),o.needsUpdate=!0),o}function t(o,r){let a=e.THREE;if(!r||typeof r!="object")return o;for(let l in r)r[l]instanceof Object?o[l]={...r[l]}:g.isThreeColorValue(l)?o[l]=new a.Color(r[l]):o[l]=r[l];return o}return{create:m,change:c}}(e);var C=function(){function m(a,l){let n={collidable:i=>r(a,i),draggable:i=>o(a,i),dragMaterial:i=>t(a,i),movingLimiter:i=>c(a,i)};for(let i in l)l[i]&&n[i]&&n[i](i);a.userData={...a.userData,...l}}function c(a,l){let n=e.THREE,i=new n.Box3;i.setFromObject(a),e.movingLimits={min:i.min,max:i.max}}function t(a,l){}function o(a,l){l&&e.draggables.push(a)}function r(a,l){l&&e.collidables.push(a)}return{handle:m}}(e);var b=function(){function m(r){let a=c(r);return e.scene.add(a),a}function c(r){let a=e.THREE,l=Array.isArray(r.args)?r.args:[],n=new a[r.type](...l);return n=t(n,r),n}function t(r,a){return a.properties&&(r=o(r,a.properties)),a.methods&&(r=g.applyMethods(r,a.methods)),r}function o(r,a){let l=e.THREE;if(!a||typeof a!="object")return r;for(let n in a)if(a[n]instanceof Object)if(typeof r[n]!="undefined"&&"copy"in r[n]){if("toVector3"in r[n]&&"setFromVector3"in r[n]){let u=new l.Vector3;u.setFromEuler(r[n]);let f={...u,...a[n]};r[n].setFromVector3(f)}let i={...r[n],...a[n]};r[n].copy(i)}else n==="userData"?C.handle(r,a[n]):r[n]=o(r[n],a[n]);else g.isThreeColorValue(n)?r[n]=new l.Color(a[n]):r[n]=a[n];return r}return{add:m,create:c,change:t}}(e);var L=function(){function m(){let r=e.options;e.camera=t(r.camera),e.scene=c(r.scene),e.initSize()}function c(r){let a=b.create(r);return(async()=>{a.background=await o(r.background),a.environment=await o(r.environment)})(),a}function t(r){let a=b.create(r);return a.updateProjectionMatrix(),a}async function o(r){if(!r)return null;let a=e.THREE,l=r.loader||"TextureLoader";return await new a[l](e.manager).loadAsync(r.url)}return{init:m}}(e);var A=function(){function m(t,o){e.controls[t.name]=c(t,o)}function c(t,o){let r=new t(e.camera,e.renderer.domElement);return r=b.change(r,o),r}return{init:m}}(e);var M=function(){let m={};function c(o){m[o.name]=new o(e.manager)}async function t(o){return await m[o.loader].loadAsync(o.url)}return{init:c,load:t}}(e);var H=function(){function m(r){return b.create(r)}function c(r,a){return r=b.change(r,a),r}function t(r){if(typeof r=="object"&&r.type)return o(r);let a=[];return Array.isArray(r)&&r.forEach(l=>{let n=o(l);a.push(n)}),a}function o(r){let a=m(r);return e.scene.add(a),a}return{add:t,create:m,change:c}}(e);var R=function(){function m(c){c||(c={type:"BoxGeometry",args:[1,1,1]},e.info("No options for geometry given, using default BoxGeometry 1x1x1"));let t=e.create(c);return t=g.merge(t,c.properties),t}return{create:m}}(e);var j=function(){function m(n){let i=e.THREE,u=v.create(n.material),f=R.create(n.geometry),y=new i.Mesh(f,u);return y=a(y,n),y}function c(n){if(typeof n=="object"){if(n.loader)return t(n);if(n.geometry)return r(n)}let i=[];return Array.isArray(n)&&n.forEach(u=>{let f=c(u);i.push(f)}),i}async function t(n){let i=await M.load(n);if(i.scene){let u=o(i.scene,n);return u=a(u,n),u.receiveShadow=!1,u.castShadow=!1,e.scene.add(u),u}else return i=a(i,n),e.scene.add(i),i}function o(n,i){let u=e.THREE,f=new u.Box3().setFromObject(n),y=f.getCenter(new u.Vector3),w=.001,E={x:f.max.x-f.min.x+w,y:f.max.y-f.min.y+w,z:f.max.z-f.min.z+w},s=new u.BoxGeometry(E.x,E.y,E.z);i.material||(i.material={color:16777215,transparent:!0,opacity:0});let d=new u.MeshBasicMaterial(i.material),p=new u.Mesh(s,d);return p.position.y=E.y/2,n.position.x+=n.position.x-y.x,n.position.y+=n.position.y-y.y,n.position.z+=n.position.z-y.z,p.renderOrder=1,n.traverse(h=>{h.isMesh&&(h.receiveShadow=i.properties.receiveShadow||!1,h.castShadow=i.properties.castShadow||!1,h.material.side=u.DoubleSide)}),p.add(n),p}function r(n){let i=m(n);return e.scene.add(i),i}function a(n,i){return n=b.change(n,i),i.material&&v.change(n.material,i.material),n}function l(n){e.collidables=e.collidables.filter(i=>i!==n),e.draggables=e.draggables.filter(i=>i!==n),e.scene.remove(n)}return{add:c,create:m,change:a,remove:l}}(e);var x=function(){let m=null,c=null,t=null,o=null,r=null;function a(){let u=e.THREE;c=new u.Plane,t=new u.Vector3(0,1,0),o=new u.Vector3,r=new u.Vector3}function l(){let u=e.raycaster.intersectObjects(e.draggables);if(u.length<=0)return;o.copy(u[0].point),c.setFromNormalAndCoplanarPoint(t,o),r.subVectors(u[0].object.position,u[0].point),e.draggableObject=u[0].object,e.controls.OrbitControls.enabled=!1,e.actions.isDragging=!0,e.canvas.style.cursor="grab";let f=e.draggableObject.userData?.callbacks?.onDragStart??(()=>{});typeof e.draggableObject.userData?.callbacks?.onDragStart=="string"&&(f=new Function("return "+e.draggableObject.userData.callbacks.onDragStart)()),f(e),e.draggableObject.userData.dragMaterial&&(m=e.draggableObject.material,e.draggableObject.material=v.create(e.draggableObject.userData.dragMaterial))}function n(){if(e.controls.OrbitControls.enabled=!0,e.actions.isDragging=!1,e.canvas.style.cursor="auto",e.draggableObject){let u=e.draggableObject.userData?.callbacks?.onDragStop??(()=>{});typeof e.draggableObject.userData?.callbacks?.onDragStop=="string"&&(u=new Function("return "+e.draggableObject.userData.callbacks.onDragStop)()),u(e)}e.draggableObject&&e.draggableObject.userData.dragMaterial&&(e.draggableObject.material=m,m=null),e.draggableObject=null}function i(){if(!e.actions.isDragging)return;e.draggableObject.position.addVectors(o,r),e.movingLimits!==null&&(e.movingLimits.min.y=e.draggableObject.position.y,e.movingLimits.max.y=e.draggableObject.position.y,e.draggableObject.position.clamp(e.movingLimits.min,e.movingLimits.max));let u=e.draggableObject.userData?.callbacks?.onDrag??(()=>{});typeof e.draggableObject.userData?.callbacks?.onDrag=="string"&&(u=new Function("return "+e.draggableObject.userData.callbacks.onDrag)()),u(e),e.raycaster.ray.intersectPlane(c,o)}return{init:a,start:l,drag:i,stop:n}}();var k=function(){async function m(){let r=e.THREE;e.raycaster=e.raycaster??new r.Raycaster,e.mouse=e.mouse??{},x.init(e.draggables);let a=await e.renderer.domElement;a.addEventListener("mousemove",l=>{o(l)}),a.addEventListener("mousedown",l=>{c(l)}),a.addEventListener("mouseup",l=>{t(l)})}function c(r){x.start()}function t(){x.stop()}function o(r){let a=e.canvas.getBoundingClientRect();e.mouse.x=(r.clientX-a.left)/(a.right-a.left)*2-1,e.mouse.y=-((r.clientY-a.top)/(a.bottom-a.top))*2+1,e.raycaster.setFromCamera(e.mouse,e.camera),x.drag()}return{init:m}}();var z=function(){let m=[];function c(o){let r=e.THREE,a=!1,l=new r.Box3().setFromObject(o);return m.length=0,e.collidables.forEach(n=>{if(n===o)return;let i=new r.Box3().setFromObject(n);l.intersectsBox(i)&&(m.push(n),a=!0)}),a}function t(){return m}return{check:c,getCurrentCollisions:t}}(e);console.log("klee.js: "+T);export{e as App,z as Collision,A as Controls,x as Dragging,k as Events,R as Geometry,j as Item,T as KLEEVERSION,H as Light,M as Loaders,v as Material,b as Object3d,L as Scene,C as UserData};
//# sourceMappingURL=klee.min.js.map
