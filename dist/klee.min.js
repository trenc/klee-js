var L="0.5.0";function A(m){return{debugLevel:0,responsive:!0,renderer:{type:"WebGLRenderer",args:[{antialias:!0,preserveDrawingBuffer:!0,alpha:!0}],domElement:"body",clearColor:"#000000",opacity:1,properties:{shadowMap:{enabled:!0,type:m.PCFSoftShadowMap}}},camera:{type:"PerspectiveCamera",methods:{lookAt:[0,0,0]},properties:{position:{x:-1,y:2,z:5},name:"camera-1",fov:35,aspect:window.innerWidth/window.innerHeight,near:1,far:300}},scene:{type:"Scene",properties:{name:"scene-1",position:{x:0,y:0,z:0}}}}}var p=class{static merge(s,r){if(!r||typeof r!="object")return s;for(let a of Object.keys(r))r[a]instanceof Object&&typeof s[a]!="undefined"&&Object.assign(r[a],this.merge(s[a],r[a]));return Object.assign(s||{},r),s}static isThreeColorValue(s){return["color","specular","emissive","diffuse","background","sheen"].includes(s)}static applyMethods(s,r){r=r||{};for(let a in r){let e=Array.isArray(r[a])?r[a]:[];a in s?s[a](...e):console.log("Applied object has no method: "+a)}return s}};var n=function(){let m={},s,r={canvas:null,camera:null,renderer:null,scene:null,mouse:null,raycaster:null,manager:null,controls:{OrbitControls:null},movingLimits:null,draggables:[],collidables:[],actions:{isDragging:!1}};function a(c,f={}){(!c||!c.REVISION)&&d("THREE is not inserted"),s={...c},(!f||typeof f!="object")&&(f={},h("Options are set to default values")),m={...p.merge(A(s),f)},r.renderer=o(m.renderer),r.manager=new s.LoadingManager}function e(c){r.renderer.render(r.scene,r.camera),r.controls.OrbitControls&&(r.controls.OrbitControls.enableDamping||r.controls.OrbitControls.autoRotate)&&r.controls.OrbitControls.update(),typeof c=="function"&&c(),requestAnimationFrame(()=>e(c))}function t(){let c=m.responsive||!1,f=r.camera.fov,g=r.canvas.clientWidth,b=r.canvas.clientWidth,w=r.canvas.clientHeight;if(r.renderer.setSize(b,w),r.camera.aspect=b/w,r.camera.updateProjectionMatrix(),c===!1)return;new ResizeObserver(F=>{let M=window.innerWidth;b=r.canvas.clientWidth,w=r.canvas.clientHeight,M!==b&&(r.renderer.setSize(M,w),r.camera.aspect=M/w,r.camera.fov=f*g/M,r.camera.updateProjectionMatrix())}).observe(document.querySelector("body"))}function o(c){r.domElement=document.querySelector(c.domElement),r.domElement instanceof HTMLCanvasElement&&(c.args.canvas=r.domElement,r.canvas=r.domElement);let f=i(c);return f=l(f,c.properties),f.setClearColor(new s.Color(c.clearColor),c.opacity),f.setPixelRatio(window.devicePixelRatio),r.canvas||(r.domElement.appendChild(f.domElement),r.canvas=f.domElement),f.setSize(r.canvas.clientWidth,r.canvas.clientHeight),f}function i(c){let f=Array.isArray(c.args)?c.args:[];return new s[c.type](...f)}function l(c,f){return p.merge(c,f)}function u(c,f){let g=m.debugLevel!==void 0?m.debugLevel:3;switch(f){case"error":throw c;case"warn":g>0&&console.warn(c);break;case"info":g>2&&console.info(c);break;default:g>1&&console.log(c);break}}function d(c){u(c,"error")}function h(c){u(c,"warn")}function E(c){u(c,"log")}function R(c){u(c,"info")}return{get canvas(){return r.canvas},get options(){return m},get THREE(){return s},get scene(){return r.scene},set scene(c){r.scene=c},get camera(){return r.camera},set camera(c){r.camera=c},get controls(){return r.controls},get renderer(){return r.renderer},get manager(){return r.manager},get collidables(){return r.collidables},set collidables(c){r.collidables=c},get draggables(){return r.draggables},set draggables(c){r.draggables=c},get mouse(){return r.mouse},set mouse(c){r.mouse=c},get movingLimits(){return r.movingLimits},set movingLimits(c){r.movingLimits=c},get raycaster(){return r.raycaster},set raycaster(c){r.raycaster=c},get actions(){return r.actions},initSize:t,create:i,error:d,warn:h,log:E,info:R,init:a,run:e}}();var x=function(){function m(a){a||(a={type:"MeshPhongMaterial",args:[{color:16777215}]},n.info("No options for material given, using default MeshPhongMaterial in white"));let e=n.create(a);return e=s(e,a),e}function s(a,e){let t=n.THREE;return e.properties&&(a=r(a,e.properties)),e.methods&&(a=p.applyMethods(a,e.methods)),e.textures&&(e.textures.forEach(async o=>{let i=o.loader||"TextureLoader",l=new t[i](n.manager),u=o.map,d=await l.loadAsync(o.url);a[u]=d,o.properties&&(a[u]=r(a[u],o.properties)),o.methods&&(a[u]=p.applyMethods(a,o.methods))}),a.needsUpdate=!0),a}function r(a,e){let t=n.THREE;if(!e||typeof e!="object")return a;for(let o in e)e[o]instanceof Object?a[o]={...e[o]}:p.isThreeColorValue(o)?a[o]=new t.Color(e[o]):a[o]=e[o];return a}return{create:m,change:s}}(n);var C=function(){function m(t,o){let i={collidable:l=>e(t,l),draggable:l=>a(t,l),dragMaterial:l=>r(t,l),movingLimiter:l=>s(t,l)};for(let l in o)i[l]&&i[l](l);t.userData={...t.userData,...o}}function s(t,o){let i=n.THREE,l=new i.Box3;l.setFromObject(t),n.movingLimits={min:l.min,max:l.max}}function r(t,o){}function a(t,o){o&&n.draggables.push(t)}function e(t,o){o&&n.collidables.push(t)}return{handle:m}}(n);var y=function(){function m(e){let t=s(e);return n.scene.add(t),t}function s(e){let t=n.THREE,o=Array.isArray(e.args)?e.args:[],i=new t[e.type](...o);return i=r(i,e),i}function r(e,t){return t.properties&&(e=a(e,t.properties)),t.methods&&(e=p.applyMethods(e,t.methods)),e}function a(e,t){let o=n.THREE;if(!t||typeof t!="object")return e;for(let i in t)if(t[i]instanceof Object)if(typeof e[i]!="undefined"&&"copy"in e[i]){if("toVector3"in e[i]&&"setFromVector3"in e[i]){let u=new o.Vector3;u.setFromEuler(e[i]);let d={...u,...t[i]};e[i].setFromVector3(d)}let l={...e[i],...t[i]};e[i].copy(l)}else i==="userData"?C.handle(e,t[i]):e[i]=a(e[i],t[i]);else p.isThreeColorValue(i)?e[i]=new o.Color(t[i]):e[i]=t[i];return e}return{add:m,create:s,change:r}}(n);var H=function(){function m(){let e=n.options;n.camera=r(e.camera),n.scene=s(e.scene),n.initSize()}function s(e){let t=y.create(e);return(async()=>{t.background=await a(e.background),t.environment=await a(e.environment)})(),t}function r(e){let t=y.create(e);return t.updateProjectionMatrix(),t}async function a(e){if(!e)return null;let t=n.THREE,o=e.loader||"TextureLoader";return await new t[o](n.manager).loadAsync(e.url)}return{init:m}}(n);var S=function(){function m(r,a){n.controls[r.name]=s(r,a)}function s(r,a){let e=new r(n.camera,n.renderer.domElement);return e=y.change(e,a),e}return{init:m}}(n);var O=function(){let m={};function s(a){m[a.name]=new a(n.manager)}async function r(a){return await m[a.loader].loadAsync(a.url)}return{init:s,load:r}}(n);var D=function(){function m(e){return y.create(e)}function s(e,t){return e=y.change(e,t),e}function r(e){if(typeof e=="object"&&e.type)return a(e);let t=[];return Array.isArray(e)&&e.forEach(o=>{let i=a(o);t.push(i)}),t}function a(e){let t=m(e);return n.scene.add(t),t}return{add:r,create:m,change:s}}(n);var T=function(){function m(s){s||(s={type:"BoxGeometry",args:[1,1,1]},n.info("No options for geometry given, using default BoxGeometry 1x1x1"));let r=n.create(s);return r=p.merge(r,s.properties),r}return{create:m}}(n);var z=function(){function m(o){let i=n.THREE,l=x.create(o.material),u=T.create(o.geometry),d=new i.Mesh(u,l);return d=t(d,o),d}function s(o){if(typeof o=="object"){if(o.loader)return r(o);if(o.geometry)return e(o)}let i=[];return Array.isArray(o)&&o.forEach(l=>{let u=s(l);i.push(u)}),i}async function r(o){let i=await O.load(o);if(i.scene){let l=a(i.scene,o);return l=t(l,o),l.receiveShadow=!1,l.castShadow=!1,n.scene.add(l),l}else return i=t(i,o),n.scene.add(i),i}function a(o,i){let l=n.THREE,u=new l.Box3().setFromObject(o),d=u.getCenter(new l.Vector3),h=.001,E={x:u.max.x-u.min.x+h,y:u.max.y-u.min.y+h,z:u.max.z-u.min.z+h},R=new l.BoxGeometry(E.x,E.y,E.z);i.material||(i.material={color:16777215,transparent:!0,opacity:0});let c=new l.MeshBasicMaterial(i.material),f=new l.Mesh(R,c);return f.position.y=E.y/2,o.position.x+=o.position.x-d.x,o.position.y+=o.position.y-d.y,o.position.z+=o.position.z-d.z,f.renderOrder=1,o.traverse(g=>{g.isMesh&&(g.receiveShadow=i.properties.receiveShadow||!1,g.castShadow=i.properties.castShadow||!1,g.material.side=l.DoubleSide)}),f.add(o),f}function e(o){let i=m(o);return n.scene.add(i),i}function t(o,i){return o=y.change(o,i),i.material&&x.change(o.material,i.material),o}return{add:s,create:m,change:t}}(n);var v=function(){let m=null,s=null,r=null,a=null,e=null,t=null;function o(){let d=n.THREE;s=new d.Plane,r=new d.Vector3(0,1,0),a=new d.Vector3,e=new d.Vector3}function i(){let d=n.raycaster.intersectObjects(n.draggables);d.length<=0||(a.copy(d[0].point),s.setFromNormalAndCoplanarPoint(r,a),e.subVectors(d[0].object.position,d[0].point),t=d[0].object,n.controls.OrbitControls.enabled=!1,n.actions.isDragging=!0,n.canvas.style.cursor="grab",t.userData.dragMaterial&&(m=t.material,t.material=x.create(t.userData.dragMaterial)))}function l(){n.controls.OrbitControls.enabled=!0,n.actions.isDragging=!1,n.canvas.style.cursor="auto",t&&t.userData.dragMaterial&&(t.material=m,m=null),t=null}function u(){n.actions.isDragging&&(t.position.addVectors(a,e),n.movingLimits!==null&&(n.movingLimits.min.y=t.position.y,n.movingLimits.max.y=t.position.y,t.position.clamp(n.movingLimits.min,n.movingLimits.max)),n.raycaster.ray.intersectPlane(s,a))}return{init:o,start:i,drag:u,stop:l}}();var V=function(){async function m(){let e=n.THREE;n.raycaster=n.raycaster??new e.Raycaster,n.mouse=n.mouse??{},v.init(n.draggables);let t=await n.renderer.domElement;t.addEventListener("mousemove",o=>{a(o)}),t.addEventListener("mousedown",o=>{s(o)}),t.addEventListener("mouseup",o=>{r(o)})}function s(e){v.start()}function r(){v.stop()}function a(e){let t=n.canvas.getBoundingClientRect();n.mouse.x=(e.clientX-t.left)/(t.right-t.left)*2-1,n.mouse.y=-((e.clientY-t.top)/(t.bottom-t.top))*2+1,n.raycaster.setFromCamera(n.mouse,n.camera),v.drag()}return{init:m}}();var P=function(){function m(s){let r=n.THREE,a=!1,e=new r.Box3().setFromObject(s);return n.collidables.forEach(t=>{if(t===s)return;let o=new r.Box3().setFromObject(t);e.intersectsBox(o)&&(a=!0)}),a}return{check:m}}(n);console.log("klee.js: "+L);export{n as App,P as Collision,S as Controls,v as Dragging,V as Events,T as Geometry,z as Item,L as KLEEVERSION,D as Light,O as Loaders,x as Material,y as Object3d,H as Scene};
//# sourceMappingURL=klee.min.js.map
